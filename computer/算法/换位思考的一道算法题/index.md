# 换位思考的一道算法题

> [最考验换位思考的一道算法题](https://juejin.im/post/5ad8f6cdf265da0b9d77c0e3)


## 题目

有两个大于1的整数x和y，甲知道二者的积，乙知道二者的和。

甲：我不知道这两数是什么！

乙：我不知道这两数是什么，我就知道你不知道

甲：现在我知道了

乙：我也知道了。

问这两个数是多少？


## 答案

4和13

## 思路

### 第一次换位思考


因为正确答案是4和13，那么甲知道的数字是52，甲又知道52可以写成2\*26或4*13这两种可能。因此甲不知道这两数具体是哪一种可能。

乙知道的数字是17，但17的和可能有2+15,3+14,4+13,5+12,6+11,7+18和8+9这几种可能。此时关键的信息来了，乙确信甲不知道答案。这是乙第一次进行换位思考，思考的过程如下：

假如答案是2和15，那么甲知道的是30，但是30又可以分成5*6和3\*10，因此甲没法确定答案。

同理，乙验证3和14,4和13,5和12,6和11，7和10,8和9等其余可能，推理出甲无法知道正确答案。因为他们的乘机的因式分解都不唯一。

### 第二次换位思考

因为此时乙已经告诉了甲，这一个关键信息，甲也可以反向推理：

假如是2和26的话，那么和是28.而28的和之一是5+23，那么乙会验证5*23的因式分解是否唯一，又因为其恰好为俩素数，分解必然唯一。那么乙就不会断定我不知道答案了。因此x和y不能使2和26，则是4和13。

### 第三次换位思考

乙一看甲竟然得到了答案，他进行了一次复杂的推理。

甲能得到正确答案，肯定是除了正确答案意外，排除掉了所有其他可能。排除条件就是：只有正确答案的和的分解对应乘积的因式分解全不唯一这个条件是唯一的，即我之前告诉他的，“我就知道你不知道”。

比如，看2和15是否正确，其乘积是30，而30的另一个因式分解之一5*6的和是11，并且11的所有和分解2+9,3+8,4+7,5+6的乘积因式分解也不唯一。这样的话，如果乘积真是30，到底2和15是正确答案还是5和6是正确答案？这样甲无法抉择。因此2和15不是答案。同理验证，除了4和13这一对儿外，其余可能都不能使甲得出答案。

### 我们的换位思考

我们换位思考就是想法依次从甲乙的对话里，去过滤出正确答案。

我们假设**x<=y，二者均小于100**。

首先我们先算x和y的所有可能：

```js

const max = 100; //小于一百

let sums = {};
let products = {};

for (let i = 2; i < max; i++) {
  let x = i;
  for (let d = 0; d < max - x; d++) {
    let y = x + d;

    let p = x * y;

    products[p] = products[p] || [];
    prodcuts[p].push({ x: x, y: y });

    let s = x + y;

    sums[s] = sums[s] || [];
    sums[s].push({ x: x, y: y });
  }
}


```

products是所有数的乘积的因式分解集合。比如products[12]的值是[{x:2,y:6},{x:3,y:4}].

类似，sums是所有数的和的分解。

> 甲：我不知道答案。

对应这句话，我们要在products中过滤掉因式分解唯一的情况：

```js

for(let key in products){
    if(products[key].length == 1){
        delete products[key];
    }
}


```

> 乙：我不知道答案。

同理，过滤sums中唯一的情况:

```js
for(let key in sums){
    if(sums[key].length == 1){
        delete sums[key];
    }
}

```

> 乙：我就知道你不知道！

对任何一可能和值，其每种和式分解对应的乘积都应该有多种可能分解形式。我们过滤到sums中不满足的情形：

```js
for (let key in sums) {
  let pairs = sums[key];
  let flag = pairs.every((pair) => {
     return (pair.x * pair.y) in products;
  });
  if(!flag){
    delete sums[key];
  }
}
```

> 甲：现在我知道了。<br> 乙：我也知道了。

根据乙最后换位思考的过程，我们遍历sums的每一个key。再根据排除条件，即和的分解对应的积的因式分解是否唯一，来确定可能的结果。


